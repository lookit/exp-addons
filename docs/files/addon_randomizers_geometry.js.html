<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>addon/randomizers/geometry.js - exp-player</title>
    <link rel="stylesheet" href="https://yui-s.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="icon" href="../assets/favicon.ico">
    <script src="https://yui-s.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
                <h1><img src="../assets/css/logo.png" title="exp-player" width="117" height="52"></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 0.5.1</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
                    <h2 class="off-left">APIs</h2>
                    <div id="api-tabview" class="tabview">
                        <ul class="tabs">
                            <li><a href="#api-classes">Classes</a></li>
                            <li><a href="#api-modules">Modules</a></li>
                        </ul>
                
                        <div id="api-tabview-filter">
                            <input type="search" id="api-filter" placeholder="Type to filter APIs">
                        </div>
                
                        <div id="api-tabview-panel">
                            <ul id="api-classes" class="apis classes">
                                <li><a href="../classes/ExpExitSurvey.html">ExpExitSurvey</a></li>
                                <li><a href="../classes/ExpFrameBase.html">ExpFrameBase</a></li>
                                <li><a href="../classes/ExpFrameBaseUnsafe.html">ExpFrameBaseUnsafe</a></li>
                                <li><a href="../classes/ExpLookitDialoguePage.html">ExpLookitDialoguePage</a></li>
                                <li><a href="../classes/ExpLookitExitSurvey.html">ExpLookitExitSurvey</a></li>
                                <li><a href="../classes/ExpLookitGeometryAlternation.html">ExpLookitGeometryAlternation</a></li>
                                <li><a href="../classes/ExpLookitInstructions.html">ExpLookitInstructions</a></li>
                                <li><a href="../classes/ExpLookitMoodQuestionnaire.html">ExpLookitMoodQuestionnaire</a></li>
                                <li><a href="../classes/ExpLookitPreferentialLooking.html">ExpLookitPreferentialLooking</a></li>
                                <li><a href="../classes/ExpLookitPreviewExplanation.html">ExpLookitPreviewExplanation</a></li>
                                <li><a href="../classes/ExpLookitStoryPage.html">ExpLookitStoryPage</a></li>
                                <li><a href="../classes/ExpLookitSurvey.html">ExpLookitSurvey</a></li>
                                <li><a href="../classes/ExpLookitText.html">ExpLookitText</a></li>
                                <li><a href="../classes/ExpMoodQuestionnaire.html">ExpMoodQuestionnaire</a></li>
                                <li><a href="../classes/ExpPhysicsIntro.html">ExpPhysicsIntro</a></li>
                                <li><a href="../classes/ExpPhysicsPreVideo.html">ExpPhysicsPreVideo</a></li>
                                <li><a href="../classes/ExpPhysicsPreviewExplanation.html">ExpPhysicsPreviewExplanation</a></li>
                                <li><a href="../classes/ExpPlayer.html">ExpPlayer</a></li>
                                <li><a href="../classes/ExpVideoConfig.html">ExpVideoConfig</a></li>
                                <li><a href="../classes/ExpVideoConfigQuality.html">ExpVideoConfigQuality</a></li>
                                <li><a href="../classes/ExpVideoConsent.html">ExpVideoConsent</a></li>
                                <li><a href="../classes/ExpVideoPhysics.html">ExpVideoPhysics</a></li>
                                <li><a href="../classes/ExpVideoPreview.html">ExpVideoPreview</a></li>
                                <li><a href="../classes/FullScreen.html">FullScreen</a></li>
                                <li><a href="../classes/geometry.html">geometry</a></li>
                                <li><a href="../classes/MediaReload.html">MediaReload</a></li>
                                <li><a href="../classes/permute.html">permute</a></li>
                                <li><a href="../classes/randomParameterSet.html">randomParameterSet</a></li>
                                <li><a href="../classes/videoRecorder.html">videoRecorder</a></li>
                                <li><a href="../classes/VideoRecorderObject.html">VideoRecorderObject</a></li>
                                <li><a href="../classes/VideoRecordMixin.html">VideoRecordMixin</a></li>
                            </ul>
                
                
                            <ul id="api-modules" class="apis modules">
                                <li><a href="../modules/components.html">components</a></li>
                                <li><a href="../modules/exp-player.html">exp-player</a></li>
                                <li><a href="../modules/frames.html">frames</a></li>
                                <li><a href="../modules/mixins.html">mixins</a></li>
                                <li><a href="../modules/randomizers.html">randomizers</a></li>
                                <li><a href="../modules/services.html">services</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
                    Show:
                    <label for="api-show-inherited">
                        <input type="checkbox" id="api-show-inherited" checked>
                        Inherited
                    </label>
            
                    <label for="api-show-protected">
                        <input type="checkbox" id="api-show-protected">
                        Protected
                    </label>
            
                    <label for="api-show-private">
                        <input type="checkbox" id="api-show-private">
                        Private
                    </label>
                    <label for="api-show-deprecated">
                        <input type="checkbox" id="api-show-deprecated">
                        Deprecated
                    </label>
            
                </div>
            
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
<h1 class="file-heading">File: addon/randomizers/geometry.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/**
* @module exp-player
* @submodule randomizers
*/

/**
* Randomizer to implement counterbalancing for geometry alternation study.
* To use, define a frame with &quot;kind&quot;: &quot;choice&quot; and &quot;sampler&quot;: &quot;geometry&quot;,
* as shown below, in addition to the parameters described under &#x27;properties&#x27;.
*
&#x60;&#x60;&#x60;json
&quot;frames&quot;: {
     &quot;alt-trials&quot;: {
        &quot;sampler&quot;: &quot;geometry&quot;,
        &quot;kind&quot;: &quot;choice&quot;,
        &quot;frameType&quot;: &quot;exp-lookit-geometry-alternation&quot;,
        &quot;counterbalance&quot;: {
            &quot;startPositions&quot;: [
                &quot;left&quot;,
                &quot;right&quot;
            ],
            &quot;contexts&quot;: [
                &quot;fat&quot;,
                &quot;skinny&quot;
            ]
        },
        &quot;frameOptions&quot;: {
            &quot;triangleLineWidth&quot;: 8,
            &quot;calibrationVideoSources&quot;: [
                {
                    &quot;src&quot;: &quot;https://s3.amazonaws.com/lookitcontents/geometry/webm/attention.webm&quot;,
                    &quot;type&quot;: &quot;video/webm&quot;
                },
                {
                    &quot;src&quot;: &quot;https://s3.amazonaws.com/lookitcontents/geometry/mp4/attention.mp4&quot;,
                    &quot;type&quot;: &quot;video/mp4&quot;
                }
            ],
            &quot;trialLength&quot;: 60,
            &quot;attnLength&quot;: 10,
            &quot;calibrationLength&quot;: 3000,
            &quot;fsAudio&quot;: [
                {
                    &quot;src&quot;: &quot;https://s3.amazonaws.com/lookitcontents/geometry/mp3/fullscreen.mp3&quot;,
                    &quot;type&quot;: &quot;audio/mp3&quot;
                },
                {
                    &quot;src&quot;: &quot;https://s3.amazonaws.com/lookitcontents/geometry/ogg/fullscreen.ogg&quot;,
                    &quot;type&quot;: &quot;audio/ogg&quot;
                }
            ],
            &quot;triangleColor&quot;: &quot;#056090&quot;,
            &quot;unpauseAudio&quot;: [
                {
                    &quot;src&quot;: &quot;https://s3.amazonaws.com/lookitcontents/geometry/mp3/return_after_pause.mp3&quot;,
                    &quot;type&quot;: &quot;audio/mp3&quot;
                },
                {
                    &quot;src&quot;: &quot;https://s3.amazonaws.com/lookitcontents/geometry/ogg/return_after_pause.ogg&quot;,
                    &quot;type&quot;: &quot;audio/ogg&quot;
                }
            ],
            &quot;pauseAudio&quot;: [
                {
                    &quot;src&quot;: &quot;https://s3.amazonaws.com/lookitcontents/geometry/mp3/pause.mp3&quot;,
                    &quot;type&quot;: &quot;audio/mp3&quot;
                },
                {
                    &quot;src&quot;: &quot;https://s3.amazonaws.com/lookitcontents/geometry/ogg/pause.ogg&quot;,
                    &quot;type&quot;: &quot;audio/ogg&quot;
                }
            ],
            &quot;videoSources&quot;: [
                {
                    &quot;src&quot;: &quot;https://s3.amazonaws.com/lookitcontents/exp-physics-final/stimuli/attention/webm/attentiongrabber.webm&quot;,
                    &quot;type&quot;: &quot;video/webm&quot;
                },
                {
                    &quot;src&quot;: &quot;https://s3.amazonaws.com/lookitcontents/exp-physics-final/stimuli/attention/mp4/attentiongrabber.mp4&quot;,
                    &quot;type&quot;: &quot;video/mp4&quot;
                }
            ],
            &quot;musicSources&quot;: [
                {
                    &quot;src&quot;: &quot;https://s3.amazonaws.com/lookitcontents/geometry/mp3/happy-stroll.mp3&quot;,
                    &quot;type&quot;: &quot;audio/mp3&quot;
                },
                {
                    &quot;src&quot;: &quot;https://s3.amazonaws.com/lookitcontents/geometry/ogg/happy-stroll.ogg&quot;,
                    &quot;type&quot;: &quot;audio/ogg&quot;
                }
            ],
            &quot;calibrationAudioSources&quot;: [
                {
                    &quot;src&quot;: &quot;https://s3.amazonaws.com/lookitcontents/geometry/mp3/chimes.mp3&quot;,
                    &quot;type&quot;: &quot;audio/mp3&quot;
                },
                {
                    &quot;src&quot;: &quot;https://s3.amazonaws.com/lookitcontents/geometry/ogg/chimes.ogg&quot;,
                    &quot;type&quot;: &quot;audio/ogg&quot;
                }
            ]
        }
    }
}

* &#x60;&#x60;&#x60;
* @class geometry
*/

var getRandomElement = function(arr) {
    return arr[Math.floor(Math.random() * arr.length)];
};

var randomizer = function(frameId, frame) {

    /**
     * Object describing possible values for counterbalancing conditions.
     *
     * @property {Object} counterbalance
     *   @param {String[]} startPositions list of starting positions
     *      for the triangle stream which alternates in both size and shape.
     *      (array of strings; options are &#x27;left&#x27; and &#x27;right&#x27;)
     *   @param {String[]} contextOptions list of context triangle options
     *      (array of strings; options for context are &#x27;fat&#x27;, &#x27;skinny&#x27;)
     */

    var positionOptions = frame.counterbalance.startPositions;
    var contextOptions  = frame.counterbalance.contexts;

    var position = getRandomElement(positionOptions);
    var context  = getRandomElement(contextOptions);

    position = (position === &#x27;left&#x27;);
    context  = (context  === &#x27;fat&#x27;);

    var frames = [];
    var thisFrame = {};
    for (var iFrame = 0; iFrame &lt; 4; iFrame++) {
        thisFrame = {
            /**
             * Type of frame to use, e.g. &#x27;exp-lookit-geometry-alternation&#x27;
             *
             * @property {String} frameType
             */
            kind: frame.frameType,
            id: &#x60;${frameId}&#x60;,
            altOnLeft: position,
            context: context,
            audioSources: [
                {
                    &#x27;type&#x27;: &#x27;audio/mp3&#x27;,
                    &#x27;src&#x27;: &#x27;https://s3.amazonaws.com/lookitcontents/geometry/mp3/video_0&#x27; + (iFrame + 1) + &#x27;.mp3&#x27;
                },
                {
                    &#x27;type&#x27;: &#x27;audio/ogg&#x27;,
                    &#x27;src&#x27;: &#x27;https://s3.amazonaws.com/lookitcontents/geometry/ogg/video_0&#x27; + (iFrame + 1) + &#x27;.ogg&#x27;
                }
            ]
        };
        if (iFrame === 3) {
            thisFrame.endAudioSources = [
                {
                    &#x27;type&#x27;: &#x27;audio/mp3&#x27;,
                    &#x27;src&#x27;: &#x27;https://s3.amazonaws.com/lookitcontents/geometry/mp3/all_done.mp3&#x27;
                },
                {
                    &#x27;type&#x27;: &#x27;audio/ogg&#x27;,
                    &#x27;src&#x27;: &#x27;https://s3.amazonaws.com/lookitcontents/geometry/ogg/all_done.ogg&#x27;
                }
            ];
        }

        /**
         * Object describing common parameters to use in EVERY frame created
         * by this randomizer. Parameter names and values are as described in
         * the documentation for the frameType used; see example above.
         *
         * @property {Object} frameOptions
         */

        Object.assign(thisFrame, frame.frameOptions);

        position = !position;
        //[thisFrame,] = resolveFrame(null, thisFrame);
        frames.push(thisFrame);
    }

    return [frames, {&#x27;position&#x27;: position, &#x27;context&#x27;: context}];

    // Short version for testing
    //return [[frames[0]], {&#x27;position&#x27;: position, &#x27;context&#x27;: context}];

    // Random choice...
    // Pick one option at random
    //var sample = Math.floor(Math.random() * frame.options.length);
    //var choice = frame.options[sample];

    // jscs:disable
    //var [frames,] = resolveFrame(choice);
    //return [frames, choice];

    //lib/exp-player/addon/utils/parse-experiment.js

};
export default randomizer;

    </pre>
</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
